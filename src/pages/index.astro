---
import BaseLayout from '../layouts/BaseLayout.astro';
import ProductCard from '../components/ProductCard.astro';
import PromoBanner from '../components/PromoBanner.astro';
import { getFeaturedProducts } from '../data/products';

const featuredProducts = getFeaturedProducts();
---

<BaseLayout title="Início" description="Fire Burguer.Peça já o melhor Hamburguer do Brasil!">
  
  <!-- Hero Section -->
<section class="relative bg-primary text-white py-20">
  <!-- Ícone de status Online -->
  <div class="absolute top-4 left-4 bg-white text-green-600 font-bold px-4 py-2 rounded-full flex items-center gap-2 shadow-md z-10">
    <span class="w-3 h-3 bg-green-500 rounded-full animate-ping"></span>
    <span class="w-3 h-3 bg-green-600 rounded-full absolute"></span>
    <span class="relative z-10">Aberto agora</span>
  </div>

  <div class="container mx-auto px-4 text-center">
    <h1 class="font-display font-bold text-4xl md:text-5xl lg:text-6xl mb-6">
      O melhor Hambúrguer do Brasil agora em <span id="user-city">sua cidade</span>!
    </h1>
    <p class="text-xl md:text-2xl max-w-3xl mx-auto mb-6">
      Entrega rápida, Hambúrgueres artesanais, ingredientes frescos e preço imbatível!
    </p>

    <!-- Entrega estimada -->
    <p class="text-lg md:text-xl font-medium mb-4">
      Entrega estimada: <span class="font-bold text-white">20–30 minutos</span> para a sua região
    </p>

    <div class="flex flex-wrap justify-center gap-4">
      <a href="/menu" class="bg-white text-primary font-bold py-3 px-8 rounded-lg text-lg hover:bg-opacity-90 transition-colors">
        Ver Cardápio
      </a>
    </div>
  </div>
</section>


  <!-- Destaques Section -->
  <section class="py-16 bg-background">
    <div class="container mx-auto px-4">
      <h2 class="font-display font-bold text-3xl md:text-4xl text-center mb-12">Nossos Destaques</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
        {featuredProducts.map(product => (
          <ProductCard 
            id={product.id}
            name={product.name}
            price={product.price}
            description={product.description}
            image={product.image}
            slug={product.slug}
          />
        ))}
      </div>
      
      <div class="text-center mt-12">
        <a href="/menu" class="bg-primary text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-opacity-90 transition-colors">
          Ver Cardápio Completo
        </a>
      </div>
    </div>
  </section>

  <!-- Promo Banner -->
  <PromoBanner 
  title={`Promoção Especial de ${new Date().toLocaleDateString('pt-BR', {weekday: 'long'}).replace(/^\w/, c => c.toUpperCase())}`}
  description={`${['sábado', 'domingo'].includes(new Date().toLocaleDateString('pt-BR', {weekday: 'long'})) ? 'Todo' : 'Toda'} ${new Date().toLocaleDateString('pt-BR', {weekday: 'long'})}, nossos hambúrgueres e combos estão com 20% de desconto. Venha experimentar o melhor hambúrguer da cidade com um preço especial!`}
  buttonText="Ver Hambúrgueres"
  buttonLink="/menu#hambúrgueres"
  image="https://images.unsplash.com/photo-1568901346375-23c9450c58cd?q=80&w=800"
/>

  <!-- Testimonials Section -->
  <section class="py-16 bg-secondary text-white">
    <div class="container mx-auto px-4">
      <h2 class="font-display font-bold text-3xl md:text-4xl text-center mb-12">O que Nossos Clientes Dizem</h2>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <div class="bg-white text-dark p-6 rounded-lg shadow-md">
          <div class="text-yellow-400 flex mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
          </div>
          <p class="text-gray-700 mb-4">"A pizza é simplesmente incrível! Massa perfeita, ingredientes frescos e um atendimento impecável. Definitivamente o melhor restaurante da cidade."</p>
          <div class="flex items-center">
            <span class="font-bold text-secondary mr-2">Ana Silva</span>
            <span class="text-gray-500 text-sm">Cliente desde 2020</span>
          </div>
        </div>
        
        <div class="bg-white text-dark p-6 rounded-lg shadow-md">
          <div class="text-yellow-400 flex mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
          </div>
          <p class="text-gray-700 mb-4">"As massas são um espetáculo à parte. Sempre frescas e com molhos incríveis. O ambiente é aconchegante e o serviço é excelente. Recomendo!"</p>
          <div class="flex items-center">
            <span class="font-bold text-secondary mr-2">Carlos Oliveira</span>
            <span class="text-gray-500 text-sm">Cliente desde 2019</span>
          </div>
        </div>
        
        <div class="bg-white text-dark p-6 rounded-lg shadow-md">
          <div class="text-yellow-400 flex mb-4">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
              <path fill-rule="evenodd" d="M10.788 3.21c.448-1.077 1.976-1.077 2.424 0l2.082 5.007 5.404.433c1.164.093 1.636 1.545.749 2.305l-4.117 3.527 1.257 5.273c.271 1.136-.964 2.033-1.96 1.425L12 18.354 7.373 21.18c-.996.608-2.231-.29-1.96-1.425l1.257-5.273-4.117-3.527c-.887-.76-.415-2.212.749-2.305l5.404-.433 2.082-5.006z" clip-rule="evenodd" />
            </svg>
          </div>
          <p class="text-gray-700 mb-4">"Os hambúrgueres são sensacionais! A carne é suculenta e os ingredientes são sempre frescos. Além disso, o atendimento é impecável. Sempre volto com a família."</p>
          <div class="flex items-center">
            <span class="font-bold text-secondary mr-2">Pedro Santos</span>
            <span class="text-gray-500 text-sm">Cliente desde 2021</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- CTA Section -->
  <section class="bg-accent py-16">
    <div class="container mx-auto px-4 text-center">
      <h2 class="font-display font-bold text-3xl md:text-4xl text-secondary mb-6">Pronto para experimentar?</h2>
      <p class="text-dark text-xl mb-8 max-w-2xl mx-auto">
        Venha conhecer nosso restaurante ou faça seu pedido online. Estamos prontos para proporcionar uma experiência gastronômica inesquecível.
      </p>
      <div class="flex flex-wrap justify-center gap-4">
        <a href="/menu" class="bg-primary text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-opacity-90 transition-colors">
          Ver Cardápio
        </a>
        <a href="/contact" class="bg-secondary text-white font-bold py-3 px-8 rounded-lg text-lg hover:bg-opacity-90 transition-colors">
          Fazer Reserva
        </a>
      </div>
    </div>
  </section>
  
  <!-- Second Promo Banner -->
  <div class="container mx-auto px-4 py-12">
    <PromoBanner 
      title="Delivery com Frete Grátis" 
      description="Para pedidos acima de R$ 100,00, oferecemos frete grátis para toda a cidade. Peça agora mesmo e receba em casa nossa comida deliciosa!"
      buttonText="Fazer Pedido"
      buttonLink="/menu"
      image="https://images.unsplash.com/photo-1613226505855-91f3a4998b1c?q=80&w=800"
      position="left"
    />
  </div>
</BaseLayout>


<script>
  // Function to get user's city
  async function getUserCity() {
    const cityElement = document.getElementById('user-city');
    
    try {
      // First try IP-based geolocation (doesn't require permission)
      const response = await fetch('https://ipapi.co/json/');
      const data = await response.json();
      
      if (data && data.city) {
        if (cityElement) {
          cityElement.textContent = data.city;
        }
      } else {
        // Fallback to browser geolocation if IP geolocation fails
        navigator.geolocation.getCurrentPosition(async (position) => {
          try {
            const { latitude, longitude } = position.coords;
            const geoResponse = await fetch(
              `https://nominatim.openstreetmap.org/reverse?format=json&lat=${latitude}&lon=${longitude}&zoom=10`
            );
            const geoData = await geoResponse.json();
            
            if (geoData && geoData.address && geoData.address.city) {
              if (cityElement) {
                cityElement.textContent = geoData.address.city;
              }
            } else if (geoData && geoData.address && geoData.address.town) {
              if (cityElement) {
                cityElement.textContent = geoData.address.town;
              }
            }
          } catch (error) {
            console.error("Error getting location details:", error);
          }
        }, (error) => {
          console.error("Geolocation error:", error);
        });
      }
    } catch (error) {
      console.error("Error fetching location:", error);
    }
  }

  // Call the function when the page loads
  document.addEventListener('DOMContentLoaded', getUserCity);
</script>